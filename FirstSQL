
CREATE TABLE Patients (
    patient_id INTEGER PRIMARY KEY,
    name TEXT NOT NULL,
    age INTEGER,
    gender TEXT,
    city TEXT
);

--This is the code for creating the Patients table--

INSERT INTO Patients (patient_id, name, age, gender, city) VALUES
(1, 'John Doe', 45, 'M', 'Boston'),
(2, 'Jane Smith', 32, 'F', 'Cambridge'),
(3, 'Mike Johnson', 58, 'M', 'Boston'),
(4, 'Sarah Williams', 41, 'F', 'Somerville'),
(5, 'David Brown', 29, 'M', 'Boston'),
(6, 'Emily Davis', 67, 'F', 'Cambridge');

--This is inserting the data for patients and their details into the Patients table--

select * from Patients;

--This selects all of the data in Patients, selecting each row and column--

select * FROM Patients 
WHERE gender = 'F';

--This selects all of the data where the gender is female--

SELECT name, age 
FROM Patients;

--This selects only the Name and Age column data for all rows of the patients in Patients--

SELECT * FROM Patients
Where age > 40;

--This selects all of the data for people whose age is over 40 in the Patients table--

select count (*)FROM Patients;

--This counts the number of subjects in the Patients table--

SELECT Count (distinct city) from Patients;

--This counts the amount of distinct cities in the Patients table--

select distinct city from Patients;

--This selects the distinct cities in the Patients table and shows them--

Select avg(age) from Patients;
select min(age) from Patients;
select max(age) from Patients;
select sum(age) from Patients;

--These commands select and show the average, minimum, maximum, and sum of ages in the Patients table--

SELECT gender,avg(age) Avg_age
From Patients 
Group BY gender
order by 2;

--This selects the average age of patients divided by gender in the Patients table--
--It shows only gender and age columns--
--It is ordered by average age--

select city, min(age) Min_Age
from patients 
group by city
order by 2;

--This shows the minimum age of patients grouped into their cities--
--It shows only city and age columns--
--It is put in order by the minimum age--

select city, max(age) Max_age
from Patients
group by city
order by 1 Desc;

--This shows the maximum age of patients grouped by their cities--
--It shows only city and age columns-- 
--It is shown in order of maximum age--

CREATE TABLE Visits (
    visit_id INTEGER PRIMARY KEY,
    patient_id INTEGER,
    visit_date TEXT,
    diagnosis TEXT,
    cost REAL,
    FOREIGN KEY (patient_id) REFERENCES Patients(patient_id)
  );

--This creates the data for the Visits table and respective input types--

  INSERT INTO Visits (visit_id, patient_id, visit_date, diagnosis, cost) VALUES
(101, 1, '2024-01-15', 'Hypertension', 150.00),
(102, 1, '2024-03-20', 'Diabetes', 200.00),
(103, 2, '2024-02-10', 'Flu', 100.00),
(104, 3, '2024-01-25', 'Hypertension', 150.00),
(105, 3, '2024-02-14', 'Back Pain', 180.00),
(106, 4, '2024-03-05', 'Diabetes', 200.00),
(108, 6, '2024-02-20', 'Arthritis', 220.00),
(109, 6, '2024-03-15', 'Hypertension', 150.00);

--This inserts the visit data with details for each visit into the Visits table--

select * from Visits;

--This selects all of the data from the Visits table--
--It includes all rows and columns--

select p.patient_id, visit_id, diagnosis, city 
from Patients p Left JOIN Visits v
on p.patient_id = v.patient_id;

--This joins fields from Patients (Patient ID, City) and Visits (Visit ID, Diagnosis) tables into one table--
--It is organized by the common field, Patient ID, in both tables--

Select avg(cost), city
from Patients p Join Visits v 
on p.patient_id = v.patient_id
group by city;

--This joins the fields Cost (from Visits table) and City (From Patients table) and displays them--
--Cost is averaged and grouped by city--
--The tables are joined by the common field, Patient ID, from both tables--
